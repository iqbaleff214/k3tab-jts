import{d as p,j as Ye,D as qe,k as Ge,o as a,c as Ae,w as c,b as d,a as e,v as Me,K as Ke,s as Re,e as r,h as C,t,F as D,g as A,L as T,f as g,B as We,n as V,G as He,i,y as M}from"./app.584c462a.js";import{_ as Je}from"./AppLayout.39ca853b.js";import{_ as Qe}from"./Breadcrumb.eac0b6e8.js";import{_ as Oe}from"./Button.0c94c83b.js";import{_ as O}from"./SecondaryButton.dff8c3e2.js";import{_ as je}from"./DangerButton.69d1fa9d.js";import{_ as Xe,a as Ze,b as et}from"./Pagination.39bc4326.js";import{a as E}from"./DialogModal.91ef6ae3.js";import{_ as tt}from"./Checkbox.1293985e.js";import"./_plugin-vue_export-helper.cdc0426e.js";const st=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Service Order ",-1),ot={class:"py-12"},at={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},rt={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},lt={class:"flex items-center justify-between"},ct={class:"flex flex-row space-x2"},nt=e("option",{value:""},"All Status",-1),dt=["value"],it={key:0,class:"flex flex-row space-x-2"},ut=i("Create"),_t=i("Mark As Done"),ht={key:0,class:"w-4 p-4"},pt={class:"flex items-center"},gt=["id","value"],mt=["for"],yt={scope:"row",class:"px-6 py-4 font-medium text-orange-500 cursor-pointer dark:text-white whitespace-nowrap"},vt=["textContent","onClick"],ft={key:1,class:"px-6 py-4"},bt={key:2,class:"px-6 py-4"},xt={key:3,class:"px-6 py-4"},kt={key:4,class:"px-6 py-4"},wt={class:"px-6 py-4"},St={key:5,class:"px-6 py-4"},$t={class:"flex justify-between mb-1"},Ct={class:"text-xs font-medium text-gray-700 dark:text-white"},Dt=e("span",{class:"text-sm font-medium text-gray-700 dark:text-white"},"45%",-1),zt={class:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700"},At={key:6,class:"px-6 py-4"},Mt={key:7,class:"px-6 py-4"},Ot={key:8,class:"px-6 py-4 text-right"},jt=i(" Edit "),Nt={class:"flex items-center justify-between"},It=e("div",null," Detail Service Order ",-1),Lt={class:"flex items-center"},Bt=e("span",{class:"ml-2 text-sm text-gray-600"},"Work Progress Only",-1),Pt={key:0},Tt={key:0,class:"relative border-l border-gray-200 dark:border-gray-700"},Vt=e("div",{class:"absolute w-3 h-3 bg-gray-200 rounded-full mt-1.5 -left-1.5 border border-white dark:border-gray-900 dark:bg-gray-700"},null,-1),Et={class:"mb-1 text-sm font-normal leading-none text-gray-400 dark:text-gray-500"},Ft={class:"text-lg font-semibold text-gray-900 dark:text-white"},Ut={class:"text-base font-normal text-gray-500 dark:text-gray-400"},Yt={key:0},qt=["src"],Gt=["href"],Kt={key:1,class:"relative border-l border-gray-200 dark:border-gray-700"},Rt=e("div",{class:"absolute w-3 h-3 bg-gray-200 rounded-full mt-1.5 -left-1.5 border border-white dark:border-gray-900 dark:bg-gray-700"},null,-1),Wt={class:"mb-1 text-sm font-normal leading-none text-gray-400 dark:text-gray-500"},Ht={class:"text-lg font-semibold text-gray-900 dark:text-white"},Jt={class:"text-base font-normal text-gray-500 dark:text-gray-400"},Qt={key:0},Xt=["src"],Zt=["href"],es={key:1,class:"w-full overflow-x-scroll text-sm text-left mt-4 text-gray-500 dark:text-gray-400"},ts={class:"hover:bg-gray-50"},ss=e("th",{class:"capitalize px-6 py-4 font-medium"},"service order no",-1),os={class:"hover:bg-gray-50"},as=e("th",{class:"capitalize px-6 py-4 font-medium"},"status",-1),rs={class:"hover:bg-gray-50"},ls=e("th",{class:"capitalize px-6 py-4 font-medium"},"supervisor",-1),cs={class:"hover:bg-gray-50"},ns=e("th",{class:"capitalize px-6 py-4 font-medium"},"foreman PIC",-1),ds={class:"hover:bg-gray-50"},is=e("th",{class:"capitalize px-6 py-4 font-medium"},"serviceman",-1),us={class:"hover:bg-gray-50"},_s=e("th",{class:"capitalize px-6 py-4 font-medium"},"segment",-1),hs={class:"hover:bg-gray-50"},ps=e("th",{class:"capitalize px-6 py-4 font-medium"},"equipment number",-1),gs={class:"hover:bg-gray-50"},ms=e("th",{class:"capitalize px-6 py-4 font-medium"},"job code",-1),ys={class:"hover:bg-gray-50"},vs=e("th",{class:"capitalize px-6 py-4 font-medium"},"component name",-1),fs={class:"hover:bg-gray-50"},bs=e("th",{class:"capitalize px-6 py-4 font-medium"},"smu",-1),xs={class:"hover:bg-gray-50"},ks=e("th",{class:"capitalize px-6 py-4 font-medium"},"warranty?",-1),ws={class:"hover:bg-gray-50"},Ss=e("th",{class:"capitalize px-6 py-4 font-medium"},"pip/psp",-1),$s={class:"hover:bg-gray-50"},Cs=e("th",{class:"capitalize px-6 py-4 font-medium"},"section",-1),Ds={class:"hover:bg-gray-50"},zs=e("th",{class:"capitalize px-6 py-4 font-medium"},"customer name",-1),As={class:"hover:bg-gray-50"},Ms=e("th",{class:"capitalize px-6 py-4 font-medium"},"service team",-1),Os={class:"hover:bg-gray-50"},js=e("th",{class:"capitalize px-6 py-4 font-medium"},"customer no",-1),Ns={class:"hover:bg-gray-50"},Is=e("th",{class:"capitalize px-6 py-4 font-medium"},"sales model",-1),Ls={class:"hover:bg-gray-50"},Bs=e("th",{class:"capitalize px-6 py-4 font-medium"},"serial number",-1),Ps={class:"hover:bg-gray-50"},Ts=e("th",{class:"capitalize px-6 py-4 font-medium"},"arr. no",-1),Vs={class:"hover:bg-gray-50"},Es=e("th",{class:"capitalize px-6 py-4 font-medium"},"std hours",-1),Fs={class:"hover:bg-gray-50"},Us=e("th",{class:"capitalize px-6 py-4 font-medium"},"job description",-1),Ys={class:"hover:bg-gray-50"},qs=e("th",{class:"capitalize px-6 py-4 font-medium"},"date received",-1),Gs={class:"hover:bg-gray-50"},Ks=e("th",{class:"capitalize px-6 py-4 font-medium"},"servicemen",-1),Rs=i(" Close "),Ws=i(" Control Card "),Hs=i(" Mark as Done "),Js=i(" Cancel "),Qs=i(" Mark As Done "),Xs=i(" Delete Account "),Zs=i(" Cancel "),eo=i(" Delete Accounts "),_o={__name:"Index",props:{data:Object,search:String,status:String},setup(h){const z=h,u=p([]),Ne=Ye(()=>u.value.length==z.data.data.length),j=p(!0),l=p({}),N=p(!1),Ie=n=>{N.value=!0,l.value=n},F=()=>N.value=!1,I=()=>u.value.length=0,Le=n=>{n?u.value=z.data.data.map(_=>_.id):I()},L=p(!1),U=p(!1),Be=()=>L.value=!0,B=()=>L.value=!1,P=()=>U.value=!1,Y=p(["Service Order No","Customer","Serviceman","Status","Approved Progress"]),Pe=[{name:"To Do",value:"todo"},{name:"In Progress",value:"in_progress"},{name:"Done",value:"done"}],Te=[{label:"Service Order",url:null}],q=/(\.jpg|\.jpeg|\.png|\.gif)$/i;qe(()=>{const n=Ge().props.value.user;["customer"].includes(n.role)&&(Y.value=["Service Order No","Serial Number","Model","Status","Progress"])});const Ve=n=>{M.Inertia.get(route("service-orders.index"),{search:n,status:z.status},{preserveState:!0,preserveScroll:!0})},Ee=n=>{M.Inertia.get(route("service-orders.index"),{search:z.search,status:n.target.value},{preserveState:!0,preserveScroll:!0})},Fe=()=>{M.Inertia.delete(route("service-orders.destroy",u.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{P(),I()}})},Ue=()=>{M.Inertia.put(route("service-orders.done"),{data:u.value},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{B(),I()}})};return(n,_)=>(a(),Ae(Je,{title:"Service Order"},{header:c(()=>[st,d(Qe,{links:Te})]),default:c(()=>[e("div",ot,[e("div",at,[e("div",rt,[d(et,{columns:Y.value,checkbox:["supervisor"].includes(n.$page.props.user.role),action:["foreman"].includes(n.$page.props.user.role),onSelectAllToggle:Le,checkboxState:A(Ne)},{header:c(()=>[e("div",lt,[e("div",ct,[d(Xe,{placeholder:"SO No or Customer",search:h.search,onSearch:Ve},null,8,["search"]),Me(e("select",{"onUpdate:modelValue":_[0]||(_[0]=s=>Re(status)?status.value=s:null),onChange:_[1]||(_[1]=s=>Ee(s)),id:"group",class:"border-gray-300 mt-1 block w-3/4 hidden md:block text-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm"},[nt,(a(),r(D,null,C(Pe,s=>e("option",{key:s.value,value:s.value},t(s.name),9,dt)),64))],544),[[Ke,h.status]])]),["supervisor"].includes(n.$page.props.user.role)?(a(),r("div",it,[d(A(T),{href:n.route("service-orders.create")},{default:c(()=>[d(Oe,null,{default:c(()=>[ut]),_:1})]),_:1},8,["href"]),["supervisor","foreman","serviceman"].includes(n.$page.props.user.role)?(a(),Ae(O,{key:0,disabled:u.value.length==0,onClick:Be},{default:c(()=>[_t]),_:1},8,["disabled"])):g("",!0)])):g("",!0)])]),tbody:c(()=>[(a(!0),r(D,null,C(h.data.data,s=>{var m,y,v,f,b,x,k,w;return a(),r("tr",{key:s,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[["supervisor"].includes(n.$page.props.user.role)?(a(),r("td",ht,[e("div",pt,[Me(e("input",{id:`checkbox-table-${s.id}`,value:s.id,"onUpdate:modelValue":_[2]||(_[2]=S=>u.value=S),type:"checkbox",class:"w-4 h-4 text-yellow-600 bg-gray-100 border-gray-300 rounded focus:ring-yellow-500 dark:focus:ring-yellow-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,8,gt),[[We,u.value]]),e("label",{for:`checkbox-table-${s.id}`,class:"sr-only"},"checkbox",8,mt)])])):g("",!0),e("th",yt,[e("span",{textContent:t(s.service_order_no),onClick:S=>Ie(s)},null,8,vt)]),["customer"].includes(n.$page.props.user.role)?(a(),r("td",ft,t((m=s.serial_number)!=null?m:"-"),1)):(a(),r("td",bt,t((y=s.customer_name)!=null?y:"-"),1)),["customer"].includes(n.$page.props.user.role)?(a(),r("td",xt,t((v=s.model)!=null?v:"-"),1)):(a(),r("td",kt,t(s.serviceman?(f=s.serviceman)==null?void 0:f.name:"-"),1)),e("td",wt,t(s.service_order_status),1),["customer","sales_support"].includes(n.$page.props.user.role)?(a(),r("td",St,[e("div",$t,[e("span",Ct,"Last updated: "+t(new Date(s.updated_at).toLocaleString("id-ID")),1),Dt]),e("div",zt,[e("div",{class:V([{"bg-red-500":s.progress_percentage<20&&s.progress_percentage>=0,"bg-orange-500":s.progress_percentage<60&&s.progress_percentage>=20,"bg-yellow-400":s.progress_percentage<80&&s.progress_percentage>=60,"bg-green-500":s.progress_percentage<100&&s.progress_percentage>=80},"h-2.5 rounded-full shim-green"]),style:He({width:`${s.progress_percentage}%`})},null,6)])])):n.$page.props.user.role=="supervisor"?(a(),r("td",At,t(`${(b=s.control_card_accepted)==null?void 0:b.length}/${(x=s.control_card_approved)==null?void 0:x.length}`),1)):(a(),r("td",Mt,t(`${(k=s.control_card_accepted)==null?void 0:k.length}/${(w=s.control_card)==null?void 0:w.length}`),1)),["foreman"].includes(n.$page.props.user.role)?(a(),r("td",Ot,[d(A(T),{class:"font-medium text-yellow-600 dark:text-yellow-500 hover:underline",href:n.route("service-orders.edit",s.id)},{default:c(()=>[jt]),_:2},1032,["href"])])):g("",!0)])}),128))]),footer:c(()=>[d(Ze,{links:h.data.links,next:h.data.next_page_url,prev:h.data.prev_page_url},null,8,["links","next","prev"])]),_:1},8,["columns","checkbox","action","checkboxState"])])])]),d(E,{show:N.value,onClose:F},{title:c(()=>[e("div",Nt,[It,e("label",Lt,[d(tt,{checked:j.value,"onUpdate:checked":_[3]||(_[3]=s=>j.value=s),name:"timeline"},null,8,["checked"]),Bt])])]),content:c(()=>{var s,m,y,v,f,b,x,k,w,S,G,K,R,W,H,J,Q,X,Z,ee,te,se,oe,ae,re,le,ce,ne,de,ie,ue,_e,he,pe,ge,me,ye,ve,fe,be,xe,ke,we,Se,$e,Ce,De,ze;return[j.value?(a(),r("div",Pt,[["customer","sales_support"].includes(n.$page.props.user.role)?(a(),r("ol",Tt,[(a(!0),r(D,null,C((s=l.value)==null?void 0:s.control_card_accepted,o=>{var $;return a(),r("li",{class:"mb-10 ml-4",key:o.id},[Vt,e("time",Et,t(new Date(o.created_at).toLocaleString("id-ID")),1),e("h3",Ft,t(o==null?void 0:o.special_note),1),e("p",Ut,t(($=o==null?void 0:o.reporter)==null?void 0:$.name),1),o.attachments.length?(a(),r("div",Yt,[q.exec(o.attachments[0].path)?(a(),r("img",{key:0,src:o.attachments[0].path,alt:"Attachment",class:"w-full my-2 rounded-lg"},null,8,qt)):(a(),r("a",{key:1,href:o.attachments[0].path,class:"text-xs text-orange-500",target:"_blank"},"Open Attachment in New Tab",8,Gt))])):g("",!0)])}),128))])):(a(),r("ol",Kt,[(a(!0),r(D,null,C((m=l.value)==null?void 0:m.control_card,o=>{var $;return a(),r("li",{class:"mb-10 ml-4",key:o.id},[Rt,e("time",Wt,t(new Date(o.created_at).toLocaleString("id-ID")),1),e("h3",Ht,t(o==null?void 0:o.special_note),1),e("p",Jt,t(($=o==null?void 0:o.reporter)==null?void 0:$.name),1),o.attachments.length?(a(),r("div",Qt,[q.exec(o.attachments[0].path)?(a(),r("img",{key:0,src:o.attachments[0].path,alt:"Attachment",class:"w-full my-2 rounded-lg"},null,8,Xt)):(a(),r("a",{key:1,href:o.attachments[0].path,class:"text-xs text-orange-500",target:"_blank"},"Open Attachment in New Tab",8,Zt))])):g("",!0),e("p",null,[e("span",{class:V(["bg-gray-100 text-gray-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded dark:bg-gray-200 dark:text-gray-900",{"bg-yellow-100 text-yellow-800 dark:bg-yellow-200 dark:text-yellow-900":o==null?void 0:o.is_approved}])},"Approved by Foreman",2),e("span",{class:V(["bg-gray-100 text-gray-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded dark:bg-gray-200 dark:text-gray-900",{"bg-yellow-100 text-yellow-800 dark:bg-yellow-200 dark:text-yellow-900":o==null?void 0:o.is_accepted}])},"Approved by Supervisor",2)])])}),128))]))])):(a(),r("table",es,[e("tbody",null,[e("tr",ts,[ss,e("td",null,t((v=(y=l.value)==null?void 0:y.service_order_no)!=null?v:"-"),1)]),e("tr",os,[as,e("td",null,t((b=(f=l.value)==null?void 0:f.service_order_status)!=null?b:"-"),1)]),e("tr",rs,[ls,e("td",null,t((w=(k=(x=l.value)==null?void 0:x.supervisor)==null?void 0:k.name)!=null?w:"-"),1)]),e("tr",cs,[ns,e("td",null,t((K=(G=(S=l.value)==null?void 0:S.foreman)==null?void 0:G.name)!=null?K:"-"),1)]),e("tr",ds,[is,e("td",null,t((H=(W=(R=l.value)==null?void 0:R.serviceman)==null?void 0:W.name)!=null?H:"-"),1)]),e("tr",us,[_s,e("td",null,t((Q=(J=l.value)==null?void 0:J.segment)!=null?Q:"-"),1)]),e("tr",hs,[ps,e("td",null,t((Z=(X=l.value)==null?void 0:X.operation)!=null?Z:"-"),1)]),e("tr",gs,[ms,e("td",null,t((te=(ee=l.value)==null?void 0:ee.job_code)!=null?te:"-"),1)]),e("tr",ys,[vs,e("td",null,t((oe=(se=l.value)==null?void 0:se.component_code)!=null?oe:"-"),1)]),e("tr",fs,[bs,e("td",null,t((re=(ae=l.value)==null?void 0:ae.smu)!=null?re:"-"),1)]),e("tr",xs,[ks,e("td",null,t((le=l.value)!=null&&le.warranty?"Yes":"No"),1)]),e("tr",ws,[Ss,e("td",null,t((ne=(ce=l.value)==null?void 0:ce.pip_psp)!=null?ne:"-"),1)]),e("tr",$s,[Cs,e("td",null,t((ie=(de=l.value)==null?void 0:de.business_area)!=null?ie:"-"),1)]),e("tr",Ds,[zs,e("td",null,t((_e=(ue=l.value)==null?void 0:ue.customer_name)!=null?_e:"-"),1)]),e("tr",As,[Ms,e("td",null,t((pe=(he=l.value)==null?void 0:he.service_team)!=null?pe:"-"),1)]),e("tr",Os,[js,e("td",null,t((me=(ge=l.value)==null?void 0:ge.customer_no)!=null?me:"-"),1)]),e("tr",Ns,[Is,e("td",null,t((ve=(ye=l.value)==null?void 0:ye.model)!=null?ve:"-"),1)]),e("tr",Ls,[Bs,e("td",null,t((be=(fe=l.value)==null?void 0:fe.serial_number)!=null?be:"-"),1)]),e("tr",Ps,[Ts,e("td",null,t((ke=(xe=l.value)==null?void 0:xe.arrg_no)!=null?ke:"-"),1)]),e("tr",Vs,[Es,e("td",null,t((Se=(we=l.value)==null?void 0:we.std_hours)!=null?Se:"0")+" hours",1)]),e("tr",Fs,[Us,e("td",null,t((Ce=($e=l.value)==null?void 0:$e.job_description)!=null?Ce:"-"),1)]),e("tr",Ys,[qs,e("td",null,t((ze=(De=l.value)==null?void 0:De.date_required)!=null?ze:"-"),1)]),e("tr",Gs,[Ks,e("td",null,[e("ul",null,[(a(!0),r(D,null,C(l.value.servicemen,o=>(a(),r("li",{key:o.id},t(o.name),1))),128))])])])])]))]}),footer:c(()=>[d(O,{onClick:F},{default:c(()=>[Rs]),_:1}),d(A(T),{href:n.route("control-cards.index",l.value.id)},{default:c(()=>[d(Oe,{class:"ml-3"},{default:c(()=>[Ws]),_:1})]),_:1},8,["href"])]),_:1},8,["show"]),d(E,{show:L.value,onClose:B},{title:c(()=>[Hs]),content:c(()=>[i(" Are you sure you want to mark as done the selected service orders? You selected "+t(u.value.length)+" service orders. ",1)]),footer:c(()=>[d(O,{onClick:B},{default:c(()=>[Js]),_:1}),d(je,{class:"ml-3",onClick:Ue},{default:c(()=>[Qs]),_:1})]),_:1},8,["show"]),d(E,{show:U.value,onClose:P},{title:c(()=>[Xs]),content:c(()=>[i(" Are you sure you want to delete the selected accounts? Once the accounts are deleted, all of their resources and data will be permanently deleted. You selected "+t(u.value.length)+" accounts. ",1)]),footer:c(()=>[d(O,{onClick:P},{default:c(()=>[Zs]),_:1}),d(je,{class:"ml-3",onClick:Fe},{default:c(()=>[eo]),_:1})]),_:1},8,["show"])]),_:1}))}};export{_o as default};
