import{d as f,j as ze,D as De,k as Me,o as n,c as k,w as o,b as c,a as e,g as _e,L as Ae,f as h,e as i,h as pe,v as Ne,B as je,t,i as r,n as ge,F as me,y as M}from"./app.3132a195.js";import{_ as Ie}from"./AppLayout.c1aa1228.js";import{_ as Be}from"./Breadcrumb.7d97b7e0.js";import{_ as Oe}from"./Button.914d69d4.js";import{_ as u}from"./SecondaryButton.672a0479.js";import{_ as ye}from"./DangerButton.f7ca450e.js";import{_ as Le,a as Pe,b as Ve}from"./Pagination.7e92034f.js";import{a as A}from"./DialogModal.6a25e617.js";import"./_plugin-vue_export-helper.cdc0426e.js";const Fe=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Control Card ",-1),Ye={class:"py-12"},qe={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Te={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},Ue={class:"flex items-center justify-between"},Ee={class:"flex flex-row space-x-2"},Re=r("Detail"),Ge=r("Create"),He=r("Delete"),Je=r("Approve"),Ke={key:0,class:"w-4 p-4"},Qe={class:"flex items-center"},We=["id","value"],Xe=["for"],Ze={scope:"row",class:"px-6 py-4 font-medium text-gray-900 dark:text-white whitespace-nowrap"},et={class:"px-6 py-4"},tt={key:0},st=["href"],ot={class:"px-6 py-4"},at={class:"px-6 py-4"},lt={key:1,class:"px-6 py-4"},rt=r(" Approve Note "),nt=r(" Cancel "),ct=r(" Approve "),dt=r(" Detail Service Order "),it={class:"w-full overflow-x-scroll text-sm text-left mt-4 text-gray-500 dark:text-gray-400"},ht={key:0,class:"hover:bg-gray-50"},ut=e("th",{class:"capitalize px-2 py-6 font-bold",width:"25%"},"foreman",-1),_t={width:"25%"},pt=e("th",{class:"capitalize px-2 py-6 font-bold",width:"25%"},"customer name",-1),gt={width:"25%"},mt=["textContent"],yt={class:"hover:bg-gray-50"},bt=e("th",{class:"capitalize px-2 py-6 font-bold",width:"25%"},"service order",-1),ft={width:"25%"},vt=e("th",{class:"capitalize px-2 py-6 font-bold",width:"25%"},"job description",-1),xt={width:"25%"},kt={class:"hover:bg-gray-50"},wt=e("th",{class:"capitalize px-2 py-6 font-bold"},"sales model",-1),Ct=e("th",{class:"capitalize px-2 py-6 font-bold"},"serial number",-1),St={class:"hover:bg-gray-50"},$t=e("th",{class:"capitalize px-2 py-6 font-bold"},"arr. no",-1),zt=e("th",{class:"capitalize px-2 py-6 font-bold"},"SMU",-1),Dt={class:"hover:bg-gray-50"},Mt=e("th",{class:"capitalize px-2 py-6 font-bold"},"equipment number",-1),At=e("th",{class:"capitalize px-2 py-6 font-bold"},"component name",-1),Nt={class:"hover:bg-gray-50"},jt=e("th",{class:"capitalize px-2 py-6 font-bold"},"segment",-1),It=e("th",{class:"capitalize px-2 py-6 font-bold"},"warranty?",-1),Bt={class:"hover:bg-gray-50"},Ot=e("th",{class:"capitalize px-2 py-6 font-bold"},"job code",-1),Lt={colspan:"3"},Pt={class:"hover:bg-gray-50"},Vt=e("th",{class:"capitalize px-2 py-6 font-bold"},"PIP/PSP",-1),Ft={colspan:"3"},Yt={class:"hover:bg-gray-50"},qt=e("th",{class:"capitalize px-2 py-6 font-bold"},"service team",-1),Tt={colspan:"3"},Ut={class:"hover:bg-gray-50"},Et=e("th",{class:"capitalize px-2 py-6 font-bold"},"section",-1),Rt={colspan:"3"},Gt={class:"hover:bg-gray-50"},Ht=e("th",{class:"capitalize px-2 py-6 font-bold"},"std hours",-1),Jt={colspan:"3"},Kt={class:"hover:bg-gray-50"},Qt=e("th",{class:"capitalize px-2 py-6 font-bold"},"date received",-1),Wt={colspan:"3"},Xt={key:1,class:"hover:bg-gray-50"},Zt=e("th",{class:"capitalize px-2 py-6 font-bold"},"servicemen",-1),es={colspan:"3"},ts={class:"w-full text-sm font-medium text-gray-900 bg-white rounded-lg border border-gray-200 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},ss={class:"flex items-center justify-between"},os=["textContent"],as={key:0,class:"text-gray-500 text-xs"},ls=r(" Close "),rs=r(" Delete Note "),ns=r(" Cancel "),cs=r(" Delete Notes "),bs={__name:"Index",props:{so:Object,data:Object,search:String},setup(s){var I;const _=s,d=f([]),be=ze(()=>d.value.length==_.data.data.length),w=()=>d.value.length=0,fe=a=>{a?d.value=_.data.data.map(v=>v.id):w()},C=f(!1),S=f(!1),$=f(!1),ve=()=>$.value=!0,N=()=>$.value=!1,xe=()=>C.value=!0,z=()=>C.value=!1,ke=()=>S.value=!0,D=()=>S.value=!1,j=f(["Date","Note","Reporter","Comment"]),we=[{label:"Service Order",url:route("service-orders.index")},{label:(I=_.so)==null?void 0:I.service_order_no,url:null},{label:"Control Card",url:null}],Ce=a=>{M.Inertia.get(route("control-cards.index",_.so.id),{search:a},{preserveState:!0,preserveScroll:!0})},Se=()=>{M.Inertia.delete(route("control-cards.destroy",{service_order:_.so.id,control_card:d.value,data:d.value}),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{z(),w()}})},$e=()=>{M.Inertia.put(route("control-cards.approve"),{data:d.value},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{D(),w()}})};return De(()=>{const a=Me().props.value.user;["serviceman","foreman","supervisor"].includes(a.role)&&j.value.push("Approval")}),(a,v)=>(n(),k(Ie,{title:"Control Card"},{header:o(()=>[Fe,c(Be,{links:we})]),default:o(()=>[e("div",Ye,[e("div",qe,[e("div",Te,[c(Ve,{columns:j.value,checkbox:["foreman","supervisor","serviceman"].includes(a.$page.props.user.role),action:[].includes(a.$page.props.user.role),onSelectAllToggle:fe,checkboxState:_e(be)},{header:o(()=>[e("div",Ue,[c(Le,{placeholder:"Note",search:s.search,onSearch:Ce},null,8,["search"]),e("div",Ee,[c(u,{onClick:ve},{default:o(()=>[Re]),_:1}),["serviceman"].includes(a.$page.props.user.role)&&a.$page.props.so.serviceman_id==a.$page.props.user.id&&a.$page.props.so.status!="done"?(n(),k(_e(Ae),{key:0,href:a.route("control-cards.create",s.so.id)},{default:o(()=>[c(Oe,null,{default:o(()=>[Ge]),_:1})]),_:1},8,["href"])):h("",!0),["foreman","supervisor","serviceman"].includes(a.$page.props.user.role)?(n(),k(u,{key:1,disabled:d.value.length==0,onClick:xe},{default:o(()=>[He]),_:1},8,["disabled"])):h("",!0),["foreman","supervisor"].includes(a.$page.props.user.role)?(n(),k(u,{key:2,disabled:d.value.length==0,onClick:ke},{default:o(()=>[Je]),_:1},8,["disabled"])):h("",!0)])])]),tbody:o(()=>[(n(!0),i(me,null,pe(s.data.data,l=>{var p,g,m,y;return n(),i("tr",{key:l,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[["foreman","supervisor","serviceman"].includes(a.$page.props.user.role)?(n(),i("td",Ke,[e("div",Qe,[Ne(e("input",{id:`checkbox-table-${l.id}`,value:l.id,"onUpdate:modelValue":v[0]||(v[0]=x=>d.value=x),type:"checkbox",class:"w-4 h-4 text-yellow-600 bg-gray-100 border-gray-300 rounded focus:ring-yellow-500 dark:focus:ring-yellow-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,8,We),[[je,d.value]]),e("label",{for:`checkbox-table-${l.id}`,class:"sr-only"},"checkbox",8,Xe)])])):h("",!0),e("th",Ze,t(new Date(l.created_at).toLocaleString("id-ID")),1),e("td",et,[r(t((p=l.special_note)!=null?p:"-")+" ",1),l.attachments.length?(n(),i("div",tt,[e("a",{href:l.attachments[0].path,class:"text-orange-500 text-xs mt-2",target:"_blank"},"Open Attachment",8,st)])):h("",!0)]),e("td",ot,t((m=(g=l.reporter)==null?void 0:g.name)!=null?m:"-"),1),e("td",at,t((y=l.comment)!=null?y:"-"),1),["serviceman","foreman","supervisor"].includes(a.$page.props.user.role)?(n(),i("td",lt,[a.$page.props.user.role!="supervisor"?(n(),i("span",{key:0,class:ge(["bg-gray-100 text-gray-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded dark:bg-gray-200 dark:text-gray-900",{"bg-yellow-100 text-yellow-800 dark:bg-yellow-200 dark:text-yellow-900":l==null?void 0:l.is_approved}])},"Foreman",2)):h("",!0),e("span",{class:ge(["bg-gray-100 text-gray-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded dark:bg-gray-200 dark:text-gray-900",{"bg-yellow-100 text-yellow-800 dark:bg-yellow-200 dark:text-yellow-900":l==null?void 0:l.is_accepted}])},"Supervisor",2)])):h("",!0)])}),128))]),footer:o(()=>[c(Pe,{links:s.data.links,next:s.data.next_page_url,prev:s.data.prev_page_url},null,8,["links","next","prev"])]),_:1},8,["columns","checkbox","action","checkboxState"])])])]),c(A,{show:S.value,onClose:D},{title:o(()=>[rt]),content:o(()=>[r(" Are you sure you want to approve the selected notes? You selected "+t(d.value.length)+" notes. ",1)]),footer:o(()=>[c(u,{onClick:D},{default:o(()=>[nt]),_:1}),c(ye,{class:"ml-3",onClick:$e},{default:o(()=>[ct]),_:1})]),_:1},8,["show"]),c(A,{show:$.value,onClose:N},{title:o(()=>[dt]),content:o(()=>{var l,p,g,m,y,x,B,O,L,P,V,F,Y,q,T,U,E,R,G,H,J,K,Q,W,X,Z,ee,te,se,oe,ae,le,re,ne,ce,de,ie;return[e("table",it,[e("tbody",null,[a.$page.props.user.role!="customer"?(n(),i("tr",ht,[ut,e("td",_t,t((g=(p=(l=s.so)==null?void 0:l.foreman)==null?void 0:p.name)!=null?g:"-"),1),pt,e("td",gt,[r(t((y=(m=s.so)==null?void 0:m.customer_name)!=null?y:"-")+" ",1),e("div",{textContent:t((x=s.so)==null?void 0:x.customer_no),class:"text-xs"},null,8,mt)])])):h("",!0),e("tr",yt,[bt,e("td",ft,t((O=(B=s.so)==null?void 0:B.service_order_no)!=null?O:"-"),1),vt,e("td",xt,t((P=(L=s.so)==null?void 0:L.job_description)!=null?P:"-"),1)]),e("tr",kt,[wt,e("td",null,t((F=(V=s.so)==null?void 0:V.model)!=null?F:"-"),1),Ct,e("td",null,t((q=(Y=s.so)==null?void 0:Y.serial_number)!=null?q:"-"),1)]),e("tr",St,[$t,e("td",null,t((U=(T=s.so)==null?void 0:T.arrg_no)!=null?U:"-"),1),zt,e("td",null,t((R=(E=s.so)==null?void 0:E.smu)!=null?R:"-"),1)]),e("tr",Dt,[Mt,e("td",null,t((H=(G=s.so)==null?void 0:G.operation)!=null?H:"-"),1),At,e("td",null,t((K=(J=s.so)==null?void 0:J.component_code)!=null?K:"-"),1)]),e("tr",Nt,[jt,e("td",null,t((W=(Q=s.so)==null?void 0:Q.segment)!=null?W:"-"),1),It,e("td",null,t((X=s.so)!=null&&X.warranty?"Yes":"No"),1)]),e("tr",Bt,[Ot,e("td",Lt,t((ee=(Z=s.so)==null?void 0:Z.job_code)!=null?ee:"-"),1)]),e("tr",Pt,[Vt,e("td",Ft,t((se=(te=s.so)==null?void 0:te.pip_psp)!=null?se:"-"),1)]),e("tr",Yt,[qt,e("td",Tt,t((ae=(oe=s.so)==null?void 0:oe.service_team)!=null?ae:"-"),1)]),e("tr",Ut,[Et,e("td",Rt,t((re=(le=s.so)==null?void 0:le.business_area)!=null?re:"-"),1)]),e("tr",Gt,[Ht,e("td",Jt,t((ce=(ne=s.so)==null?void 0:ne.std_hours)!=null?ce:"0")+" hours",1)]),e("tr",Kt,[Qt,e("td",Wt,t((ie=(de=s.so)==null?void 0:de.date_required)!=null?ie:"-"),1)]),a.$page.props.user.role!="customer"?(n(),i("tr",Xt,[Zt,e("td",es,[e("ul",ts,[(n(!0),i(me,null,pe(s.so.servicemen,b=>{var he,ue;return n(),i("li",{key:b.id,class:"py-2 px-4 w-full rounded-t-lg border-b border-gray-200 dark:border-gray-600"},[e("div",ss,[e("div",null,[e("span",{textContent:t(b.salary_number),class:"mr-4 font-semibold text-orange-500"},null,8,os),r(" "+t(b.name),1)]),(he=b.servicemen)!=null&&he.created_at?(n(),i("span",as,t(new Date((ue=b.servicemen)==null?void 0:ue.created_at).toLocaleString("id-ID")),1)):h("",!0)])])}),128))])])])):h("",!0)])])]}),footer:o(()=>[c(u,{onClick:N},{default:o(()=>[ls]),_:1})]),_:1},8,["show"]),c(A,{show:C.value,onClose:z},{title:o(()=>[rs]),content:o(()=>[r(" Are you sure you want to delete the selected notes? Once the notes are deleted, all of their resources and data will be permanently deleted. You selected "+t(d.value.length)+" notes. ",1)]),footer:o(()=>[c(u,{onClick:z},{default:o(()=>[ns]),_:1}),c(ye,{class:"ml-3",onClick:Se},{default:o(()=>[cs]),_:1})]),_:1},8,["show"])]),_:1}))}};export{bs as default};
