import{d as v,j as Pe,D as Le,k as Be,o as a,c as xe,w as c,b as n,a as e,v as ke,K as Te,s as Ve,e as r,h as z,t,F as A,g as O,L as E,f as p,B as Ee,n as U,G as Ue,i,y as j}from"./app.3132a195.js";import{_ as qe}from"./AppLayout.c1aa1228.js";import{_ as Fe}from"./Breadcrumb.7d97b7e0.js";import{_ as we}from"./Button.914d69d4.js";import{_ as N}from"./SecondaryButton.672a0479.js";import{_ as Se}from"./DangerButton.f7ca450e.js";import{_ as Re,a as Ye,b as Ge}from"./Pagination.7e92034f.js";import{a as q}from"./DialogModal.6a25e617.js";import{_ as Ke}from"./Checkbox.e19d533d.js";import"./_plugin-vue_export-helper.cdc0426e.js";const We=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Service Order ",-1),He={class:"py-12"},Je={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Qe={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},Xe={class:"flex items-center justify-between"},Ze={class:"flex flex-row space-x2"},et=e("option",{value:""},"All Status",-1),tt=["value"],st={key:0,class:"flex flex-row space-x-2"},ot=i("Create"),at=i("Mark As Done"),rt={key:0,class:"w-4 p-4"},lt={class:"flex items-center"},ct=["id","value"],dt=["for"],nt={scope:"row",class:"px-6 py-4 font-medium text-orange-500 cursor-pointer dark:text-white whitespace-nowrap"},it=["textContent","onClick"],ut={key:1,class:"px-6 py-4"},_t={key:2,class:"px-6 py-4"},pt={key:3,class:"px-6 py-4"},ht={key:4,class:"px-6 py-4"},gt={key:5,class:"px-6 py-4"},yt={class:"px-6 py-4"},vt={key:6,class:"px-6 py-4"},bt={class:"flex justify-between mb-1"},ft={class:"text-xs font-medium text-gray-700 dark:text-white"},mt={class:"text-sm font-medium text-gray-700 dark:text-white"},xt={class:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700"},kt={key:7,class:"px-6 py-4"},wt={key:8,class:"px-6 py-4"},St={key:9,class:"px-6 py-4 text-right"},$t=i(" Edit "),Ct={class:"flex items-center justify-between"},Dt=e("div",null," Detail Service Order ",-1),zt={class:"flex items-center"},At=e("span",{class:"ml-2 text-sm text-gray-600"},"Work Progress Only",-1),Mt={key:0},Ot={key:0,class:"relative border-l border-gray-200 dark:border-gray-700"},jt=e("div",{class:"absolute w-3 h-3 bg-gray-200 rounded-full mt-1.5 -left-1.5 border border-white dark:border-gray-900 dark:bg-gray-700"},null,-1),Nt={class:"mb-1 text-sm font-normal leading-none text-gray-400 dark:text-gray-500"},It={class:"text-lg font-semibold text-gray-900 dark:text-white"},Pt={class:"text-base font-normal text-gray-500 dark:text-gray-400"},Lt={class:"text-xs font-normal text-gray-400 dark:text-gray-400"},Bt={key:0},Tt=["src"],Vt=["href"],Et={key:1,class:"relative border-l border-gray-200 dark:border-gray-700"},Ut=e("div",{class:"absolute w-3 h-3 bg-gray-200 rounded-full mt-1.5 -left-1.5 border border-white dark:border-gray-900 dark:bg-gray-700"},null,-1),qt={class:"mb-1 text-sm font-normal leading-none text-gray-400 dark:text-gray-500"},Ft={class:"text-lg font-semibold text-gray-900 dark:text-white"},Rt={class:"text-base font-normal text-gray-500 dark:text-gray-400"},Yt={class:"text-xs font-normal text-gray-400 dark:text-gray-400"},Gt={key:0},Kt=["src"],Wt=["href"],Ht={key:1,class:"w-full overflow-x-scroll text-sm text-left mt-4 text-gray-500 dark:text-gray-400"},Jt={key:0,class:"hover:bg-gray-50"},Qt=e("th",{class:"capitalize px-2 py-6 font-bold",width:"25%"},"foreman",-1),Xt={width:"25%"},Zt=e("th",{class:"capitalize px-2 py-6 font-bold",width:"25%"},"customer name",-1),es={width:"25%"},ts=["textContent"],ss={class:"hover:bg-gray-50"},os=e("th",{class:"capitalize px-2 py-6 font-bold",width:"25%"},"service order",-1),as={width:"25%"},rs=e("th",{class:"capitalize px-2 py-6 font-bold",width:"25%"},"job description",-1),ls={width:"25%"},cs={class:"hover:bg-gray-50"},ds=e("th",{class:"capitalize px-2 py-6 font-bold"},"sales model",-1),ns=e("th",{class:"capitalize px-2 py-6 font-bold"},"serial number",-1),is={class:"hover:bg-gray-50"},us=e("th",{class:"capitalize px-2 py-6 font-bold"},"arr. no",-1),_s=e("th",{class:"capitalize px-2 py-6 font-bold"},"SMU",-1),ps={class:"hover:bg-gray-50"},hs=e("th",{class:"capitalize px-2 py-6 font-bold"},"equipment number",-1),gs=e("th",{class:"capitalize px-2 py-6 font-bold"},"component name",-1),ys={class:"hover:bg-gray-50"},vs=e("th",{class:"capitalize px-2 py-6 font-bold"},"segment",-1),bs=e("th",{class:"capitalize px-2 py-6 font-bold"},"warranty?",-1),fs={class:"hover:bg-gray-50"},ms=e("th",{class:"capitalize px-2 py-6 font-bold"},"job code",-1),xs={colspan:"3"},ks={class:"hover:bg-gray-50"},ws=e("th",{class:"capitalize px-2 py-6 font-bold"},"PIP/PSP",-1),Ss={colspan:"3"},$s={class:"hover:bg-gray-50"},Cs=e("th",{class:"capitalize px-2 py-6 font-bold"},"service team",-1),Ds={colspan:"3"},zs={class:"hover:bg-gray-50"},As=e("th",{class:"capitalize px-2 py-6 font-bold"},"section",-1),Ms={colspan:"3"},Os={class:"hover:bg-gray-50"},js=e("th",{class:"capitalize px-2 py-6 font-bold"},"std hours",-1),Ns={colspan:"3"},Is={class:"hover:bg-gray-50"},Ps=e("th",{class:"capitalize px-2 py-6 font-bold"},"date received",-1),Ls={colspan:"3"},Bs={key:1,class:"hover:bg-gray-50"},Ts=e("th",{class:"capitalize px-2 py-6 font-bold"},"servicemen",-1),Vs={colspan:"3"},Es={class:"w-full text-sm font-medium text-gray-900 bg-white rounded-lg border border-gray-200 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},Us={class:"flex items-center justify-between"},qs=["textContent"],Fs={key:0,class:"text-gray-500 text-xs"},Rs=i(" Close "),Ys=i(" Control Card "),Gs=i(" Mark as Done "),Ks=i(" Cancel "),Ws=i(" Mark As Done "),Hs=i(" Delete Account "),Js=i(" Cancel "),Qs=i(" Delete Accounts "),no={__name:"Index",props:{data:Object,search:String,status:String},setup(y){const M=y,u=v([]),$e=Pe(()=>u.value.length==M.data.data.length),I=v(!0),d=v({}),P=v(!1),Ce=l=>{P.value=!0,d.value=l},F=()=>P.value=!1,L=()=>u.value.length=0,De=l=>{l?u.value=M.data.data.map(_=>_.id):L()},B=v(!1),R=v(!1),ze=()=>B.value=!0,T=()=>B.value=!1,V=()=>R.value=!1,Y=v(["Service Order No","Customer","Serviceman","Status","Approved Progress"]),Ae=[{name:"To Do",value:"todo"},{name:"In Progress",value:"in_progress"},{name:"Done",value:"done"}],Me=[{label:"Service Order",url:null}],G=/(\.jpg|\.jpeg|\.png|\.gif)$/i;Le(()=>{const l=Be().props.value.user;["customer"].includes(l.role)&&(Y.value=["Service Order No","Serial Number","Equipment Number","Sales Model","Status","Progress"])});const Oe=l=>{j.Inertia.get(route("service-orders.index"),{search:l,status:M.status},{preserveState:!0,preserveScroll:!0})},je=l=>{j.Inertia.get(route("service-orders.index"),{search:M.search,status:l.target.value},{preserveState:!0,preserveScroll:!0})},Ne=()=>{j.Inertia.delete(route("service-orders.destroy",u.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{V(),L()}})},Ie=()=>{j.Inertia.put(route("service-orders.done"),{data:u.value},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{T(),L()}})};return(l,_)=>(a(),xe(qe,{title:"Service Order"},{header:c(()=>[We,n(Fe,{links:Me})]),default:c(()=>[e("div",He,[e("div",Je,[e("div",Qe,[n(Ge,{columns:Y.value,checkbox:["supervisor"].includes(l.$page.props.user.role),action:["foreman"].includes(l.$page.props.user.role),onSelectAllToggle:De,checkboxState:O($e)},{header:c(()=>[e("div",Xe,[e("div",Ze,[n(Re,{placeholder:"SO No or Customer",search:y.search,onSearch:Oe},null,8,["search"]),ke(e("select",{"onUpdate:modelValue":_[0]||(_[0]=o=>Ve(status)?status.value=o:null),onChange:_[1]||(_[1]=o=>je(o)),id:"group",class:"border-gray-300 mt-1 block w-3/4 hidden md:block text-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm"},[et,(a(),r(A,null,z(Ae,o=>e("option",{key:o.value,value:o.value},t(o.name),9,tt)),64))],544),[[Te,y.status]])]),["supervisor"].includes(l.$page.props.user.role)?(a(),r("div",st,[n(O(E),{href:l.route("service-orders.create")},{default:c(()=>[n(we,null,{default:c(()=>[ot]),_:1})]),_:1},8,["href"]),["supervisor","foreman","serviceman"].includes(l.$page.props.user.role)?(a(),xe(N,{key:0,disabled:u.value.length==0,onClick:ze},{default:c(()=>[at]),_:1},8,["disabled"])):p("",!0)])):p("",!0)])]),tbody:c(()=>[(a(!0),r(A,null,z(y.data.data,o=>{var b,f,m,x,k,w,S,$,C;return a(),r("tr",{key:o,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[["supervisor"].includes(l.$page.props.user.role)?(a(),r("td",rt,[e("div",lt,[ke(e("input",{id:`checkbox-table-${o.id}`,value:o.id,"onUpdate:modelValue":_[2]||(_[2]=D=>u.value=D),type:"checkbox",class:"w-4 h-4 text-yellow-600 bg-gray-100 border-gray-300 rounded focus:ring-yellow-500 dark:focus:ring-yellow-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,8,ct),[[Ee,u.value]]),e("label",{for:`checkbox-table-${o.id}`,class:"sr-only"},"checkbox",8,dt)])])):p("",!0),e("th",nt,[e("span",{textContent:t(o.service_order_no),onClick:D=>Ce(o)},null,8,it)]),["customer"].includes(l.$page.props.user.role)?(a(),r("td",ut,t((b=o.serial_number)!=null?b:"-"),1)):(a(),r("td",_t,t((f=o.customer_name)!=null?f:"-"),1)),["customer"].includes(l.$page.props.user.role)?(a(),r("td",pt,t((m=o.operation)!=null?m:"-"),1)):p("",!0),["customer"].includes(l.$page.props.user.role)?(a(),r("td",ht,t((x=o.model)!=null?x:"-"),1)):(a(),r("td",gt,t(o.serviceman?(k=o.serviceman)==null?void 0:k.name:"-"),1)),e("td",yt,t(o.service_order_status),1),["customer","sales_support"].includes(l.$page.props.user.role)?(a(),r("td",vt,[e("div",bt,[e("span",ft,"Last updated: "+t(new Date(o.updated_at).toLocaleString("id-ID")),1),e("span",mt,t(`${o.progress_percentage}%`),1)]),e("div",xt,[e("div",{class:U([{"bg-red-500":o.progress_percentage<20&&o.progress_percentage>=0,"bg-orange-500":o.progress_percentage<60&&o.progress_percentage>=20,"bg-yellow-400":o.progress_percentage<80&&o.progress_percentage>=60,"bg-green-500":o.progress_percentage<100&&o.progress_percentage>=80},"h-2.5 rounded-full shim-green"]),style:Ue({width:`${o.progress_percentage}%`})},null,6)])])):l.$page.props.user.role=="supervisor"?(a(),r("td",kt,t(`${(w=o.control_card_accepted)==null?void 0:w.length}/${(S=o.control_card_approved)==null?void 0:S.length}`),1)):(a(),r("td",wt,t(`${($=o.control_card_accepted)==null?void 0:$.length}/${(C=o.control_card)==null?void 0:C.length}`),1)),["foreman"].includes(l.$page.props.user.role)?(a(),r("td",St,[n(O(E),{class:"font-medium text-yellow-600 dark:text-yellow-500 hover:underline",href:l.route("service-orders.edit",o.id)},{default:c(()=>[$t]),_:2},1032,["href"])])):p("",!0)])}),128))]),footer:c(()=>[n(Ye,{links:y.data.links,next:y.data.next_page_url,prev:y.data.prev_page_url},null,8,["links","next","prev"])]),_:1},8,["columns","checkbox","action","checkboxState"])])])]),n(q,{show:P.value,onClose:F},{title:c(()=>[e("div",Ct,[Dt,e("label",zt,[n(Ke,{checked:I.value,"onUpdate:checked":_[3]||(_[3]=o=>I.value=o),name:"timeline"},null,8,["checked"]),At])])]),content:c(()=>{var o,b,f,m,x,k,w,S,$,C,D,K,W,H,J,Q,X,Z,ee,te,se,oe,ae,re,le,ce,de,ne,ie,ue,_e,pe,he,ge,ye,ve,be,fe,me;return[I.value?(a(),r("div",Mt,[["customer","sales_support"].includes(l.$page.props.user.role)?(a(),r("ol",Ot,[(a(!0),r(A,null,z((o=d.value)==null?void 0:o.control_card_accepted,s=>{var h,g;return a(),r("li",{class:"mb-10 ml-4",key:s.id},[jt,e("time",Nt,t(new Date(s.created_at).toLocaleString("id-ID")),1),e("h3",It,t(s==null?void 0:s.special_note),1),e("p",Pt,t(s==null?void 0:s.comment),1),e("p",Lt,"Reported by: "+t((h=s==null?void 0:s.reporter)==null?void 0:h.name),1),(g=s.attachments)!=null&&g.length?(a(),r("div",Bt,[G.exec(s.attachments[0].path)?(a(),r("img",{key:0,src:s.attachments[0].path,alt:"Attachment",class:"w-full my-2 rounded-lg"},null,8,Tt)):(a(),r("a",{key:1,href:s.attachments[0].path,class:"text-xs text-orange-500",target:"_blank"},"Open Attachment in New Tab",8,Vt))])):p("",!0)])}),128))])):(a(),r("ol",Et,[(a(!0),r(A,null,z((b=d.value)==null?void 0:b.control_card,s=>{var h,g;return a(),r("li",{class:"mb-10 ml-4",key:s.id},[Ut,e("time",qt,t(new Date(s.created_at).toLocaleString("id-ID")),1),e("h3",Ft,t(s==null?void 0:s.special_note),1),e("p",Rt,t(s==null?void 0:s.comment),1),e("p",Yt,"Reported by: "+t((h=s==null?void 0:s.reporter)==null?void 0:h.name),1),(g=s.attachments)!=null&&g.length?(a(),r("div",Gt,[G.exec(s.attachments[0].path)?(a(),r("img",{key:0,src:s.attachments[0].path,alt:"Attachment",class:"w-full my-2 rounded-lg"},null,8,Kt)):(a(),r("a",{key:1,href:s.attachments[0].path,class:"text-xs text-orange-500",target:"_blank"},"Open Attachment in New Tab",8,Wt))])):p("",!0),e("p",null,[e("span",{class:U(["bg-gray-100 text-gray-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded dark:bg-gray-200 dark:text-gray-900",{"bg-yellow-100 text-yellow-800 dark:bg-yellow-200 dark:text-yellow-900":s==null?void 0:s.is_approved}])},"Approved by Foreman",2),e("span",{class:U(["bg-gray-100 text-gray-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded dark:bg-gray-200 dark:text-gray-900",{"bg-yellow-100 text-yellow-800 dark:bg-yellow-200 dark:text-yellow-900":s==null?void 0:s.is_accepted}])},"Approved by Supervisor",2)])])}),128))]))])):(a(),r("table",Ht,[e("tbody",null,[l.$page.props.user.role!="customer"?(a(),r("tr",Jt,[Qt,e("td",Xt,t((x=(m=(f=d.value)==null?void 0:f.foreman)==null?void 0:m.name)!=null?x:"-"),1),Zt,e("td",es,[i(t((w=(k=d.value)==null?void 0:k.customer_name)!=null?w:"-")+" ",1),e("div",{textContent:t((S=d.value)==null?void 0:S.customer_no),class:"text-xs"},null,8,ts)])])):p("",!0),e("tr",ss,[os,e("td",as,t((C=($=d.value)==null?void 0:$.service_order_no)!=null?C:"-"),1),rs,e("td",ls,t((K=(D=d.value)==null?void 0:D.job_description)!=null?K:"-"),1)]),e("tr",cs,[ds,e("td",null,t((H=(W=d.value)==null?void 0:W.model)!=null?H:"-"),1),ns,e("td",null,t((Q=(J=d.value)==null?void 0:J.serial_number)!=null?Q:"-"),1)]),e("tr",is,[us,e("td",null,t((Z=(X=d.value)==null?void 0:X.arrg_no)!=null?Z:"-"),1),_s,e("td",null,t((te=(ee=d.value)==null?void 0:ee.smu)!=null?te:"-"),1)]),e("tr",ps,[hs,e("td",null,t((oe=(se=d.value)==null?void 0:se.operation)!=null?oe:"-"),1),gs,e("td",null,t((re=(ae=d.value)==null?void 0:ae.component_code)!=null?re:"-"),1)]),e("tr",ys,[vs,e("td",null,t((ce=(le=d.value)==null?void 0:le.segment)!=null?ce:"-"),1),bs,e("td",null,t((de=d.value)!=null&&de.warranty?"Yes":"No"),1)]),e("tr",fs,[ms,e("td",xs,t((ie=(ne=d.value)==null?void 0:ne.job_code)!=null?ie:"-"),1)]),e("tr",ks,[ws,e("td",Ss,t((_e=(ue=d.value)==null?void 0:ue.pip_psp)!=null?_e:"-"),1)]),e("tr",$s,[Cs,e("td",Ds,t((he=(pe=d.value)==null?void 0:pe.service_team)!=null?he:"-"),1)]),e("tr",zs,[As,e("td",Ms,t((ye=(ge=d.value)==null?void 0:ge.business_area)!=null?ye:"-"),1)]),e("tr",Os,[js,e("td",Ns,t((be=(ve=d.value)==null?void 0:ve.std_hours)!=null?be:"0")+" hours",1)]),e("tr",Is,[Ps,e("td",Ls,t((me=(fe=d.value)==null?void 0:fe.date_required)!=null?me:"-"),1)]),l.$page.props.user.role!="customer"?(a(),r("tr",Bs,[Ts,e("td",Vs,[e("ul",Es,[(a(!0),r(A,null,z(d.value.servicemen,s=>{var h,g;return a(),r("li",{key:s.id,class:"py-2 px-4 w-full rounded-t-lg border-b border-gray-200 dark:border-gray-600"},[e("div",Us,[e("div",null,[e("span",{textContent:t(s.salary_number),class:"mr-4 font-semibold text-orange-500"},null,8,qs),i(" "+t(s.name),1)]),(h=s.servicemen)!=null&&h.created_at?(a(),r("span",Fs,t(new Date((g=s.servicemen)==null?void 0:g.created_at).toLocaleString("id-ID")),1)):p("",!0)])])}),128))])])])):p("",!0)])]))]}),footer:c(()=>[n(N,{onClick:F},{default:c(()=>[Rs]),_:1}),n(O(E),{href:l.route("control-cards.index",d.value.id)},{default:c(()=>[n(we,{class:"ml-3"},{default:c(()=>[Ys]),_:1})]),_:1},8,["href"])]),_:1},8,["show"]),n(q,{show:B.value,onClose:T},{title:c(()=>[Gs]),content:c(()=>[i(" Are you sure you want to mark as done the selected service orders? You selected "+t(u.value.length)+" service orders. ",1)]),footer:c(()=>[n(N,{onClick:T},{default:c(()=>[Ks]),_:1}),n(Se,{class:"ml-3",onClick:Ie},{default:c(()=>[Ws]),_:1})]),_:1},8,["show"]),n(q,{show:R.value,onClose:V},{title:c(()=>[Hs]),content:c(()=>[i(" Are you sure you want to delete the selected accounts? Once the accounts are deleted, all of their resources and data will be permanently deleted. You selected "+t(u.value.length)+" accounts. ",1)]),footer:c(()=>[n(N,{onClick:V},{default:c(()=>[Js]),_:1}),n(Se,{class:"ml-3",onClick:Ne},{default:c(()=>[Qs]),_:1})]),_:1},8,["show"])]),_:1}))}};export{no as default};
