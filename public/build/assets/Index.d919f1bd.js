import{d as g,j as Be,D as Ie,k as Oe,o as c,c as x,w as o,b as r,a as e,g as be,L as Ve,f as u,e as d,h as xe,v as Ye,B as Le,t as s,F as ke,i as n,y as D}from"./app.584c462a.js";import{_ as Fe}from"./AppLayout.39ca853b.js";import{_ as Te}from"./Breadcrumb.eac0b6e8.js";import{_ as qe}from"./Button.0c94c83b.js";import{_ as h}from"./SecondaryButton.dff8c3e2.js";import{_ as we}from"./DangerButton.69d1fa9d.js";import{_ as Pe,a as Ee,b as Ue}from"./Pagination.39bc4326.js";import{a as N}from"./DialogModal.91ef6ae3.js";import"./_plugin-vue_export-helper.cdc0426e.js";const Ge=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Control Card ",-1),He={class:"py-12"},Je={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Ke={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},Qe={class:"flex items-center justify-between"},Re={class:"flex flex-row space-x-2"},We=n("Detail"),Xe=n("Create"),Ze=n("Delete"),et=n("Approve"),tt={key:0,class:"w-4 p-4"},st={class:"flex items-center"},ot=["id","value"],at=["for"],lt={scope:"row",class:"px-6 py-4 font-medium text-gray-900 dark:text-white whitespace-nowrap"},rt={class:"px-6 py-4"},nt={class:"px-6 py-4"},ct={key:1,class:"px-6 py-4"},it=["href"],dt={key:2,class:"px-6 py-4"},ut={key:3,class:"px-6 py-4"},ht={key:4,class:"px-6 py-4"},pt=n(" Approve Note "),_t=n(" Cancel "),mt=n(" Approve "),vt=n(" Detail Service Order "),gt={class:"w-full overflow-x-scroll text-sm text-left mt-4 text-gray-500 dark:text-gray-400"},ft={class:"hover:bg-gray-50"},yt=e("th",{class:"capitalize px-6 py-4 font-medium"},"service order no",-1),bt={class:"hover:bg-gray-50"},xt=e("th",{class:"capitalize px-6 py-4 font-medium"},"status",-1),kt={class:"hover:bg-gray-50"},wt=e("th",{class:"capitalize px-6 py-4 font-medium"},"supervisor",-1),St={class:"hover:bg-gray-50"},Ct=e("th",{class:"capitalize px-6 py-4 font-medium"},"foreman PIC",-1),zt={class:"hover:bg-gray-50"},$t=e("th",{class:"capitalize px-6 py-4 font-medium"},"serviceman",-1),Dt={class:"hover:bg-gray-50"},Nt=e("th",{class:"capitalize px-6 py-4 font-medium"},"segment",-1),At={class:"hover:bg-gray-50"},Mt=e("th",{class:"capitalize px-6 py-4 font-medium"},"equipment number",-1),jt={class:"hover:bg-gray-50"},Bt=e("th",{class:"capitalize px-6 py-4 font-medium"},"job code",-1),It={class:"hover:bg-gray-50"},Ot=e("th",{class:"capitalize px-6 py-4 font-medium"},"component name",-1),Vt={class:"hover:bg-gray-50"},Yt=e("th",{class:"capitalize px-6 py-4 font-medium"},"smu",-1),Lt={class:"hover:bg-gray-50"},Ft=e("th",{class:"capitalize px-6 py-4 font-medium"},"warranty?",-1),Tt={class:"hover:bg-gray-50"},qt=e("th",{class:"capitalize px-6 py-4 font-medium"},"pip/psp",-1),Pt={class:"hover:bg-gray-50"},Et=e("th",{class:"capitalize px-6 py-4 font-medium"},"section",-1),Ut={class:"hover:bg-gray-50"},Gt=e("th",{class:"capitalize px-6 py-4 font-medium"},"customer name",-1),Ht={class:"hover:bg-gray-50"},Jt=e("th",{class:"capitalize px-6 py-4 font-medium"},"service team",-1),Kt={class:"hover:bg-gray-50"},Qt=e("th",{class:"capitalize px-6 py-4 font-medium"},"customer no",-1),Rt={class:"hover:bg-gray-50"},Wt=e("th",{class:"capitalize px-6 py-4 font-medium"},"sales model",-1),Xt={class:"hover:bg-gray-50"},Zt=e("th",{class:"capitalize px-6 py-4 font-medium"},"serial number",-1),es={class:"hover:bg-gray-50"},ts=e("th",{class:"capitalize px-6 py-4 font-medium"},"arr. no",-1),ss={class:"hover:bg-gray-50"},os=e("th",{class:"capitalize px-6 py-4 font-medium"},"std hours",-1),as={class:"hover:bg-gray-50"},ls=e("th",{class:"capitalize px-6 py-4 font-medium"},"job description",-1),rs={class:"hover:bg-gray-50"},ns=e("th",{class:"capitalize px-6 py-4 font-medium"},"date received",-1),cs={class:"hover:bg-gray-50"},is=e("th",{class:"capitalize px-6 py-4 font-medium"},"servicemen",-1),ds=n(" Close "),us=n(" Delete Note "),hs=n(" Cancel "),ps=n(" Delete Notes "),ws={__name:"Index",props:{so:Object,data:Object,search:String},setup(t){var M;const p=t,i=g([]),Se=Be(()=>i.value.length==p.data.data.length),k=()=>i.value.length=0,Ce=a=>{a?i.value=p.data.data.map(y=>y.id):k()},w=g(!1),S=g(!1),C=g(!1),ze=()=>C.value=!0,A=()=>C.value=!1,$e=()=>w.value=!0,z=()=>w.value=!1,De=()=>S.value=!0,$=()=>S.value=!1,f=g(["Date","Note","Serviceman","Attachment"]),Ne=[{label:"Service Order",url:route("service-orders.index")},{label:(M=p.so)==null?void 0:M.service_order_no,url:null},{label:"Control Card",url:null}],Ae=a=>{D.Inertia.get(route("control-cards.index",p.so.id),{search:a},{preserveState:!0,preserveScroll:!0})},Me=()=>{D.Inertia.delete(route("control-cards.destroy",{service_order:p.so.id,control_card:i.value,data:i.value}),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{z(),k()}})},je=()=>{D.Inertia.put(route("control-cards.approve"),{data:i.value},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{$(),k()}})};return Ie(()=>{const a=Oe().props.value.user;["serviceman","foreman"].includes(a.role)?(f.value.push("Foreman Approved?"),f.value.push("Supervisor Approved?")):["supervisor"].includes(a.role)&&f.value.push("Approved?")}),(a,y)=>(c(),x(Fe,{title:"Control Card"},{header:o(()=>[Ge,r(Te,{links:Ne})]),default:o(()=>[e("div",He,[e("div",Je,[e("div",Ke,[r(Ue,{columns:f.value,checkbox:["foreman","supervisor","serviceman"].includes(a.$page.props.user.role),action:[].includes(a.$page.props.user.role),onSelectAllToggle:Ce,checkboxState:be(Se)},{header:o(()=>[e("div",Qe,[r(Pe,{placeholder:"Note",search:t.search,onSearch:Ae},null,8,["search"]),e("div",Re,[r(h,{onClick:ze},{default:o(()=>[We]),_:1}),["serviceman"].includes(a.$page.props.user.role)&&a.$page.props.so.serviceman_id==a.$page.props.user.id&&a.$page.props.so.status!="done"?(c(),x(be(Ve),{key:0,href:a.route("control-cards.create",t.so.id)},{default:o(()=>[r(qe,null,{default:o(()=>[Xe]),_:1})]),_:1},8,["href"])):u("",!0),["foreman","supervisor","serviceman"].includes(a.$page.props.user.role)?(c(),x(h,{key:1,disabled:i.value.length==0,onClick:$e},{default:o(()=>[Ze]),_:1},8,["disabled"])):u("",!0),["foreman","supervisor"].includes(a.$page.props.user.role)?(c(),x(h,{key:2,disabled:i.value.length==0,onClick:De},{default:o(()=>[et]),_:1},8,["disabled"])):u("",!0)])])]),tbody:o(()=>[(c(!0),d(ke,null,xe(t.data.data,l=>{var _,m,v;return c(),d("tr",{key:l,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[["foreman","supervisor","serviceman"].includes(a.$page.props.user.role)?(c(),d("td",tt,[e("div",st,[Ye(e("input",{id:`checkbox-table-${l.id}`,value:l.id,"onUpdate:modelValue":y[0]||(y[0]=b=>i.value=b),type:"checkbox",class:"w-4 h-4 text-yellow-600 bg-gray-100 border-gray-300 rounded focus:ring-yellow-500 dark:focus:ring-yellow-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,8,ot),[[Le,i.value]]),e("label",{for:`checkbox-table-${l.id}`,class:"sr-only"},"checkbox",8,at)])])):u("",!0),e("th",lt,s(new Date(l.created_at).toLocaleString("id-ID")),1),e("td",rt,s((_=l.special_note)!=null?_:"-"),1),e("td",nt,s((v=(m=l.reporter)==null?void 0:m.name)!=null?v:"-"),1),l.attachments.length?(c(),d("td",ct,[e("a",{href:l.attachments[0].path,class:"text-xs text-orange-500",target:"_blank"},"Open in New Tab",8,it)])):(c(),d("td",dt,"No")),["serviceman","foreman"].includes(a.$page.props.user.role)?(c(),d("td",ut,s(l.is_approved?"Yes":"No"),1)):u("",!0),["serviceman","foreman","supervisor"].includes(a.$page.props.user.role)?(c(),d("td",ht,s(l.is_accepted?"Yes":"No"),1)):u("",!0)])}),128))]),footer:o(()=>[r(Ee,{links:t.data.links,next:t.data.next_page_url,prev:t.data.prev_page_url},null,8,["links","next","prev"])]),_:1},8,["columns","checkbox","action","checkboxState"])])])]),r(N,{show:S.value,onClose:$},{title:o(()=>[pt]),content:o(()=>[n(" Are you sure you want to approve the selected notes? You selected "+s(i.value.length)+" notes. ",1)]),footer:o(()=>[r(h,{onClick:$},{default:o(()=>[_t]),_:1}),r(we,{class:"ml-3",onClick:je},{default:o(()=>[mt]),_:1})]),_:1},8,["show"]),r(N,{show:C.value,onClose:A},{title:o(()=>[vt]),content:o(()=>{var l,_,m,v,b,j,B,I,O,V,Y,L,F,T,q,P,E,U,G,H,J,K,Q,R,W,X,Z,ee,te,se,oe,ae,le,re,ne,ce,ie,de,ue,he,pe,_e,me,ve,ge,fe;return[e("table",gt,[e("tbody",null,[e("tr",ft,[yt,e("td",null,s((_=(l=t.so)==null?void 0:l.service_order_no)!=null?_:"-"),1)]),e("tr",bt,[xt,e("td",null,s((v=(m=t.so)==null?void 0:m.service_order_status)!=null?v:"-"),1)]),e("tr",kt,[wt,e("td",null,s((B=(j=(b=t.so)==null?void 0:b.supervisor)==null?void 0:j.name)!=null?B:"-"),1)]),e("tr",St,[Ct,e("td",null,s((V=(O=(I=t.so)==null?void 0:I.foreman)==null?void 0:O.name)!=null?V:"-"),1)]),e("tr",zt,[$t,e("td",null,s((F=(L=(Y=t.so)==null?void 0:Y.serviceman)==null?void 0:L.name)!=null?F:"-"),1)]),e("tr",Dt,[Nt,e("td",null,s((q=(T=t.so)==null?void 0:T.segment)!=null?q:"-"),1)]),e("tr",At,[Mt,e("td",null,s((E=(P=t.so)==null?void 0:P.operation)!=null?E:"-"),1)]),e("tr",jt,[Bt,e("td",null,s((G=(U=t.so)==null?void 0:U.job_code)!=null?G:"-"),1)]),e("tr",It,[Ot,e("td",null,s((J=(H=t.so)==null?void 0:H.component_code)!=null?J:"-"),1)]),e("tr",Vt,[Yt,e("td",null,s((Q=(K=t.so)==null?void 0:K.smu)!=null?Q:"-"),1)]),e("tr",Lt,[Ft,e("td",null,s((R=t.so)!=null&&R.warranty?"Yes":"No"),1)]),e("tr",Tt,[qt,e("td",null,s((X=(W=t.so)==null?void 0:W.pip_psp)!=null?X:"-"),1)]),e("tr",Pt,[Et,e("td",null,s((ee=(Z=t.so)==null?void 0:Z.business_area)!=null?ee:"-"),1)]),e("tr",Ut,[Gt,e("td",null,s((se=(te=t.so)==null?void 0:te.customer_name)!=null?se:"-"),1)]),e("tr",Ht,[Jt,e("td",null,s((ae=(oe=t.so)==null?void 0:oe.service_team)!=null?ae:"-"),1)]),e("tr",Kt,[Qt,e("td",null,s((re=(le=t.so)==null?void 0:le.customer_no)!=null?re:"-"),1)]),e("tr",Rt,[Wt,e("td",null,s((ce=(ne=t.so)==null?void 0:ne.model)!=null?ce:"-"),1)]),e("tr",Xt,[Zt,e("td",null,s((de=(ie=t.so)==null?void 0:ie.serial_number)!=null?de:"-"),1)]),e("tr",es,[ts,e("td",null,s((he=(ue=t.so)==null?void 0:ue.arrg_no)!=null?he:"-"),1)]),e("tr",ss,[os,e("td",null,s((_e=(pe=t.so)==null?void 0:pe.std_hours)!=null?_e:"0")+" hours",1)]),e("tr",as,[ls,e("td",null,s((ve=(me=t.so)==null?void 0:me.job_description)!=null?ve:"-"),1)]),e("tr",rs,[ns,e("td",null,s((fe=(ge=t.so)==null?void 0:ge.date_required)!=null?fe:"-"),1)]),e("tr",cs,[is,e("td",null,[e("ul",null,[(c(!0),d(ke,null,xe(t.so.servicemen,ye=>(c(),d("li",{key:ye.id},s(ye.name),1))),128))])])])])])]}),footer:o(()=>[r(h,{onClick:A},{default:o(()=>[ds]),_:1})]),_:1},8,["show"]),r(N,{show:w.value,onClose:z},{title:o(()=>[us]),content:o(()=>[n(" Are you sure you want to delete the selected notes? Once the notes are deleted, all of their resources and data will be permanently deleted. You selected "+s(i.value.length)+" notes. ",1)]),footer:o(()=>[r(h,{onClick:z},{default:o(()=>[hs]),_:1}),r(we,{class:"ml-3",onClick:Me},{default:o(()=>[ps]),_:1})]),_:1},8,["show"])]),_:1}))}};export{ws as default};
